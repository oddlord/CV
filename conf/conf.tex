% !TeX root = ../cv.tex
% !TEX encoding = UTF-8
% !TeX spellcheck = en_GB

\RequirePackage{bibentry}
\makeatletter\let\saved@bibitem\@bibitem\makeatother

\documentclass[\cvLanguage, a4paper]{europasscv}

\makeatletter\let\@bibitem\saved@bibitem\makeatother

\usepackage{booktabs}
\usepackage{ifthen}

\graphicspath{{img/}}

\newboolean{coursesBool}
\newboolean{projectsBool}
\newboolean{signatureBool}
\newboolean{urlsBool}
\newboolean{publicationsBool}

\newcommand{\ifBoolThenElse}[3]{\ifthenelse{\boolean{#1}}{#2}{#3}}%
\newcommand{\ifBoolThen}[2]{\ifBoolThenElse{#1}{#2}{}}%
\newcommand{\ifCourses}[1]{\ifBoolThen{coursesBool}{#1}}%
\newcommand{\ifProjects}[1]{\ifBoolThen{projectsBool}{#1}}%
\newcommand{\ifSignature}[1]{\ifBoolThen{signatureBool}{#1}}%
\newcommand{\ifURLs}[1]{\ifBoolThen{urlsBool}{#1}}%
\newcommand{\ifPublications}[1]{\ifBoolThen{publicationsBool}{#1}}%

\setboolean{coursesBool}{\enableCourses}
\setboolean{projectsBool}{\enableProjects}
\setboolean{signatureBool}{\enableSignature}
\setboolean{urlsBool}{\enableURLs}
\setboolean{publicationsBool}{\enablePublications}

\newcommand{\ifEngIta}[2]{%
  \ifthenelse{\equal{\cvLanguage}{english}}%
  {#1}%
  {%
    \ifthenelse{\equal{\cvLanguage}{italian}}%
    {#2}%
    {ERROR: WRONG LANGUAGE! Supported languages: english, italian}%
  }%
}%

\newcommand{\name}[1]{\ecvname{#1}}%
\newcommand{\address}[2]{\ecvaddress{\ifEngIta{#1}{#2}}}%
\newcommand{\cellTel}[2]{\ecvtelephone[#1]{#2}}%
\newcommand{\email}[1]{\ecvemail{#1}}%
\newcommand{\homepage}[1]{\ecvhomepage{#1}}%
\newcommand{\instantMessaging}[2]{\ecvim{#1}{#2}}%
\newcommand{\gender}[2]{\ecvgender{\ifEngIta{#1}{#2}}}%
\newcommand{\dateOfBirth}[2]{\ecvdateofbirth{\ifEngIta{#1}{#2}}}%
\newcommand{\nationality}[2]{\ecvnationality{\ifEngIta{#1}{#2}}}%
\newcommand{\avatar}[1]{\ecvpicture[width=3.8cm]{#1}}%

\newcommand{\personalInfo}{\ecvpersonalinfo}

\newcommand{\stringCommand}[3]{%
  \ifEngIta{%
    \expandafter\newcommand\csname #1String\endcsname{#2}%
  }{%
    \expandafter\newcommand\csname #1String\endcsname{#3}%
  }%
}%
\newcommand{\bigItemCommand}[1]{%
  \expandafter\newcommand\csname #1\endcsname[2]{%
    \ecvbigitem{\csname #1String\endcsname}{\ifEngIta{##1}{##2}}%
  }%
}%
\newcommand{\sectionCommand}[1]{%
  \expandafter\newcommand\csname #1\endcsname{%
    \ecvsection{\csname #1String\endcsname}%
  }%
}%
\newcommand{\titleCommand}[1]{%
  \expandafter\newcommand\csname #1\endcsname[4]{%
    \ecvtitle{\ifEngIta{##1}{##3}}{\ifEngIta{##2}{##4}}%
  }%
}%
\newcommand{\titleLevelCommand}[1]{%
  \expandafter\newcommand\csname #1\endcsname[5]{%
    \ecvtitlelevel{\ifEngIta{##1}{##3}}{\ifEngIta{##2}{##4}}{##5}%
  }%
}%
\newcommand{\ecvItemCommand}[1]{%
  \expandafter\newcommand\csname #1\endcsname[2]{%
    \ecvitem{}{\ifEngIta{##1}{##2}}%
  }%
}%
\newcommand{\ecvItemTitleCommand}[1]{%
  \expandafter\newcommand\csname #1\endcsname[2]{%
    \ecvitem{\csname #1String\endcsname}{\ifEngIta{##1}{##2}}%
  }%
}%
\newcommand{\ecvItemTitleURLCommand}[1]{%
  \expandafter\newcommand\csname #1URL\endcsname[3]{%
    \ecvitem{\csname #1String\endcsname}{\ifEngIta{##1}{##2}\addURL{##3}}%
  }%
}%

\newcommand{\addURL}[1]{\ifURLs{ - \url{#1}}}

\stringCommand{jobAppliedFor}{Job applied for}{Impiego ricercato}
\stringCommand{workExperience}{Work experience}{Esperienza professionale}
\stringCommand{educationAndTraining}{Education and training}{Istruzione e formazione}
\stringCommand{thesis}{Thesis}{Tesi}
\stringCommand{courses}{Courses}{Corsi}

\bigItemCommand{jobAppliedFor}

\sectionCommand{workExperience}
\sectionCommand{educationAndTraining}

\titleCommand{job}

\titleLevelCommand{school}

\ecvItemCommand{jobLocation}
\ecvItemCommand{jobDepartment}
\ecvItemCommand{jobDescription}
\ecvItemCommand{schoolLocation}
\ecvItemCommand{schoolFaculty}

\ecvItemTitleCommand{thesis}
\ecvItemTitleURLCommand{thesis}





\newcommand{\addItem}[2]{%
  \ecvitem{}{\ifEngIta{#1}{#2}}%
}%






\newcommand{\addCourses}[2]{%
  \ifCourses{\ecvitem{\coursesString}{\ifEngIta{#1}{#2}}}%
}%





\ifEngIta{
  \newcommand{\projectsString}{Projects}
}{
  \newcommand{\projectsString}{Progetti}
}
\newcommand{\addProjects}[1]{%
  \ifProjects{\ecvitem{\projectsString}{\begin{ecvitemize}#1\end{ecvitemize}}}%
}%
\newcommand{\addProject}[3]{%
  \item \textit{#1}: \ifEngIta{#2}{#3}%
}%
\newcommand{\addProjectURL}[4]{%
  \addProject{#1}{#2}{#3}\addURL{#4}%
}%

\ifEngIta{
  \newcommand{\finalRankString}{Final rank}
}{
  \newcommand{\finalRankString}{Voto finale}
}
\newcommand{\addFinalRank}[2]{%
  \ecvitem{\finalRankString}{\ifEngIta{#1}{#2}}%
}%

\ifEngIta{
  \newcommand{\personalSkillsString}{Personal skills}
}{
  \newcommand{\personalSkillsString}{Capacità personali}
}
\newcommand{\personalSkills}{%
  \ecvsection{\personalSkillsString}%
}%

\newcommand{\addLanguage}[7]{%
  \ecvlanguage{\ifEngIta{#1}{#2}}{#3}{#4}{#5}{#6}{#7}
}%
\newcommand{\addLastLanguage}[7]{%
  \ecvlastlanguage{\ifEngIta{#1}{#2}}{#3}{#4}{#5}{#6}{#7}
}%

\newcommand{\addMotherTongue}[2]{%
  \ecvmothertongue{\ifEngIta{#1}{#2}}%
}%
\newcommand{\addOtherLanguages}[1]{%
  \ecvlanguageheader%
  #1%
  \ecvlanguagefooter%
}%

\ifEngIta{
  \newcommand{\communicationSkillsString}{Communication skills}
}{
  \newcommand{\communicationSkillsString}{Capacità di comunicazione}
}
\newcommand{\communicationSkills}[2]{%
  \ecvblueitem{%
    \communicationSkillsString%
  }{%
    \ifEngIta{#1}{#2}%
  }%
}%

\ifEngIta{
  \newcommand{\organisationalSkillsString}{Organisational / managerial skills}
}{
  \newcommand{\organisationalSkillsString}{Capacità organizzative / manageriali}
}
\newcommand{\organisationalSkills}[2]{%
  \ecvblueitem{%
    \organisationalSkillsString%
  }{%
    \ifEngIta{#1}{#2}%
  }%
}%

\newcommand{\addList}[1]{%
  \begin{ecvitemize}%
    #1
  \end{ecvitemize}%
}%
\newcommand{\addListItem}[1]{%
  \item #1
}%

\ifEngIta{
  \newcommand{\computerSkillsString}{Computer skills}
}{
  \newcommand{\computerSkillsString}{Capacità informatiche}
}
\newcommand{\computerSkills}[2]{%
  \ecvblueitem{%
    \computerSkillsString%
  }{%
    \ifEngIta{#1}{#2}%
  }%
}%

\ifEngIta{
  \newcommand{\otherSkillsString}{Other skills}
}{
  \newcommand{\otherSkillsString}{Altre capacità}
}
\newcommand{\otherSkills}[2]{%
  \ecvblueitem{%
    \otherSkillsString%
  }{%
    \ifEngIta{#1}{#2}%
  }%
}%

\ifEngIta{
  \newcommand{\drivingLicenceString}{Driving licence}
}{
  \newcommand{\drivingLicenceString}{Patente}
}
\newcommand{\drivingLicence}[2]{%
  \ecvblueitem{%
    \drivingLicenceString%
  }{%
    \ifEngIta{#1}{#2}%
  }%
}%

\ifEngIta{
  \newcommand{\additionalInfoString}{Additional information}
}{
\newcommand{\additionalInfoString}{Ulteriori informazioni}
}
\newcommand{\additionalInfo}{%
  \ecvsection{\additionalInfoString}%
}%

\ifEngIta{
  \newcommand{\referencesString}{References}
}{
  \newcommand{\referencesString}{Referenze}
}
\newcommand{\references}[2]{%
  \ecvblueitem{%
    \referencesString%
  }{%
    \begin{ecvitemize}\ifEngIta{#1}{#2}\end{ecvitemize}%
  }%
}%
\newcommand{\addReference}[1]{%
  \addListItem{#1}%
}%

\ifEngIta{
  \newcommand{\otherProjectsString}{Other projects}
}{
  \newcommand{\otherProjectsString}{Altri progetti}
}
\newcommand{\otherProjects}[1]{%
  \ifProjects{\ecvblueitem{%
    \otherProjectsString%
  }{%
    \begin{ecvitemize}#1\end{ecvitemize}%
  }}%
}%

\ifEngIta{
  \newcommand{\publicationsString}{Publications}
}{
\newcommand{\publicationsString}{Pubblicazioni}
}
\newcommand{\addPublications}[1]{%
  \ifPublications{%
  	\bibliographystyle{plain}
    \nobibliography{publications}
    \ecvblueitem{%
      \publicationsString%
    }{%
      \begin{ecvitemize}#1\end{ecvitemize}%
    }%
  }%
}%
\newcommand{\addPublication}[1]{%
  \item \bibentry{#1}%
}%

\newcommand{\signature}{%
  \ifSignature{%
    \null\vspace*{\stretch{1}}%
    \flushright%
    \begin{tabular}{rp{250pt}}%
      \ifEngIta{%
        & \small My personal details can be processed into your data system.\\%
      }{%
        & \small Autorizzo il trattamento dei dati personali contenuti nel mio curriculum vitae in base art. 13 del \href{http://www.garanteprivacy.it/garante/doc.jsp?ID=1311248}{D. Lgs. 196/2003}.\\%
      }%
      & \\%
      \ifEngIta{%
        & Signature:\\%
      }{%
        & Firma:\\%
      }%
      & \\%
      \bottomrule%
    \end{tabular}%
  }%
}%
